{% trans_default_domain "victoire" %}

<div class="vic-dropdown vic-new-widget vic-new-widget-disabled{{ first ? " vic-first" : "" }}">
    <a data-toggle="vic-dropdown" href="#" class="text-center">
        <img src="/bundles/victoirecore/images/addWidget-icon.png" alt="new widget icon"> {{ "widget.dropdown.action.label"|trans({}, "victoire")|desc("New widget")}}
        <i class="fa fa-angle-down"></i>
    </a>
    <ul class="vic-dropdown-menu" role="menu" aria-labelledby="dLabel">
        {% for widget in widgets %}
        <li>
            <a href="{{ path('victoire_core_widget_new', {'page':page.id,'type':widget, 'slot':slot} ) }}">
                {{ ("widget."~widget~".new.action.label")|trans({}, 'victoire') }}
            </a>
        </li>
        {% endfor %}
    </ul>
</div>

<script type="text/javascript">
//responsible to hide and organize thanks to js the buttons.
//> This is not a wonderful way but for now, it does the job
    $(document).ready(function() {
        updateSlotActions{{ slot }}();
    });
    $(document).ajaxComplete(function() {
        updateSlotActions{{ slot }}();
    });

    /**
     * This function is called in widget.js file after deleting a content in order to display a potential hidden button
     */
    function updateSlotActions{{ slot }}() {
        updateSlotActions("{{ slot }}"{% if max is not null %}, {{max}}{% endif %});
    }

</script>
